import{r as y,u as D,c as P,a,o as i,b as l,w as u,_ as F,d as g,e as $,f as n,n as C,g as t,h as _,i as p,F as k,j as b,t as r,v as x,k as E,l as j,m as A,p as V,q as w}from"./app-DNYAXexi.js";/* empty css            */const ae={class:"space-y-4 z-[99]"},ie=["value"],re=["value"],de={key:0},ue={key:1},ce={class:"space-y-4"},me=["value"],pe={key:0},ve={class:"bg-gray-50 rounded-lg p-3 space-y-2"},fe={key:0,class:"font-semibold"},ye={key:0},ge={key:1},_e={class:"space-y-4"},ke=["value"],be={key:0},we={class:"bg-gray-50 rounded-lg p-3 space-y-2"},Ce={key:0,class:"font-semibold"},xe={key:0},Ee={key:1},Ke={__name:"ProductionModals",emits:["success"],setup(Ve,{expose:T,emit:L}){const q=L,S=y(!1),K=y(!1),M=y(!1),B=y([]),O=y([]),z=y([]),I=y([]),v=y(null),f=y(null),d=D({item_id:"",quantity:"",supplier_id:"",cost:"",notes:""}),c=D({component_id:"",quantity:1,notes:""}),m=D({kit_id:"",quantity:1,notes:""}),G=P(()=>v.value&&v.value.components&&v.value.components.every(s=>s.sufficient)),H=P(()=>f.value&&f.value.components&&f.value.components.every(s=>s.sufficient)),J=async()=>{try{const s=await w.get("production/api/items/element");B.value=s.data}catch(s){console.error("Error loading elements:",s)}},Q=async()=>{try{const s=await w.get("production/api/items/component");O.value=s.data}catch(s){console.error("Error loading components:",s)}},R=async()=>{try{const s=await w.get("production/api/items/kit");z.value=s.data}catch(s){console.error("Error loading kits:",s)}},W=async()=>{try{const s=await w.get("production/api/suppliers");I.value=s.data}catch(s){console.error("Error loading suppliers:",s)}},X=()=>{},Y=async()=>{if(c.component_id)try{const s=await w.get(`production/api/components/${c.component_id}`);v.value=s.data}catch(s){console.error("Error loading component data:",s)}else v.value=null},Z=async()=>{if(m.kit_id)try{const s=await w.get(`production/api/components/${m.kit_id}`);f.value=s.data}catch(s){console.error("Error loading kit data:",s)}else f.value=null},ee=async()=>{await J(),await W(),S.value=!0},oe=async()=>{await Q(),K.value=!0},te=async()=>{await R(),M.value=!0},N=()=>{S.value=!1,d.reset()},U=()=>{K.value=!1,c.reset(),v.value=null},h=()=>{M.value=!1,m.reset(),f.value=null},ne=()=>{d.post("/production/add-element",{onSuccess:()=>{N(),q("success","Elemento agregado exitosamente")}})},se=()=>{c.post("/production/add-component",{onSuccess:()=>{U(),q("success","Componente creado exitosamente")}})},le=()=>{m.post("/production/add-kit",{onSuccess:()=>{h(),q("success","Kit ensamblado exitosamente")}})};return T({openElementModal:ee,openComponentModal:oe,openKitModal:te}),(s,o)=>(i(),a(k,null,[l(A,{show:S.value,onClose:N},{title:u(()=>[...o[11]||(o[11]=[g(" Agregar Elemento al Inventario ",-1)])]),content:u(()=>[t("div",ae,[t("div",null,[l(p,{for:"element_id",value:"Elemento"}),_(t("select",{id:"element_id","onUpdate:modelValue":o[0]||(o[0]=e=>n(d).item_id=e),onChange:X,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[o[12]||(o[12]=t("option",{value:""},"Seleccionar elemento...",-1)),(i(!0),a(k,null,b(B.value,e=>(i(),a("option",{key:e.id,value:e.id},r(e.name)+" (Stock: "+r(e.current_stock)+" "+r(e.unit)+") ",9,ie))),128))],544),[[x,n(d).item_id]])]),t("div",null,[l(p,{for:"quantity",value:"Cantidad"}),l(E,{id:"quantity",modelValue:n(d).quantity,"onUpdate:modelValue":o[1]||(o[1]=e=>n(d).quantity=e),type:"number",step:"0.01",min:"0.01",class:"mt-1 block w-full",placeholder:"Ingrese la cantidad"},null,8,["modelValue"])]),t("div",null,[l(p,{for:"supplier_id",value:"Proveedor"}),_(t("select",{id:"supplier_id","onUpdate:modelValue":o[2]||(o[2]=e=>n(d).supplier_id=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[o[13]||(o[13]=t("option",{value:""},"Seleccionar proveedor...",-1)),(i(!0),a(k,null,b(I.value,e=>(i(),a("option",{key:e.id,value:e.id},r(e.name),9,re))),128))],512),[[x,n(d).supplier_id]])]),t("div",null,[l(p,{for:"cost",value:"Costo por Unidad"}),l(E,{id:"cost",modelValue:n(d).cost,"onUpdate:modelValue":o[3]||(o[3]=e=>n(d).cost=e),type:"number",step:"0.01",min:"0",class:"mt-1 block w-full",placeholder:"0.00"},null,8,["modelValue"])]),t("div",null,[l(p,{for:"element_notes",value:"Notas (Opcional)"}),_(t("textarea",{id:"element_notes","onUpdate:modelValue":o[4]||(o[4]=e=>n(d).notes=e),rows:"3",class:"mt-1 py-2 px-3 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"Notas adicionales..."},null,512),[[j,n(d).notes]])])])]),footer:u(()=>[l(F,{onClick:N},{default:u(()=>[...o[14]||(o[14]=[g(" Cancelar ",-1)])]),_:1}),l($,{class:C(["ml-3",{"opacity-25":n(d).processing}]),disabled:n(d).processing,onClick:ne},{default:u(()=>[n(d).processing?(i(),a("span",de,"Agregando...")):(i(),a("span",ue,"Agregar Elemento"))]),_:1},8,["class","disabled"])]),_:1},8,["show"]),l(A,{show:K.value,onClose:U},{title:u(()=>[...o[15]||(o[15]=[g(" Crear Componente ",-1)])]),content:u(()=>[t("div",ce,[t("div",null,[l(p,{for:"component_id",value:"Componente"}),_(t("select",{id:"component_id","onUpdate:modelValue":o[5]||(o[5]=e=>n(c).component_id=e),onChange:Y,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[o[16]||(o[16]=t("option",{value:""},"Seleccionar componente...",-1)),(i(!0),a(k,null,b(O.value,e=>(i(),a("option",{key:e.id,value:e.id},r(e.name)+" (Stock: "+r(e.current_stock)+" "+r(e.unit)+") ",9,me))),128))],544),[[x,n(c).component_id]])]),v.value&&v.value.components?(i(),a("div",pe,[o[17]||(o[17]=t("h4",{class:"text-sm font-medium text-gray-700 mb-2"},"Elementos requeridos:",-1)),t("div",ve,[(i(!0),a(k,null,b(v.value.components,e=>(i(),a("div",{key:e.item.id,class:C(["flex justify-between items-center text-sm",e.sufficient?"text-green-700":"text-red-700"])},[t("span",null,r(e.item.name),1),t("span",null,[g(" Necesario: "+r(e.quantity_needed)+" | Disponible: "+r(e.available_stock)+" ",1),e.sufficient?V("",!0):(i(),a("span",fe," ⚠️"))])],2))),128))])])):V("",!0),t("div",null,[l(p,{for:"component_quantity",value:"Cantidad a Crear"}),l(E,{id:"component_quantity",modelValue:n(c).quantity,"onUpdate:modelValue":o[6]||(o[6]=e=>n(c).quantity=e),type:"number",min:"1",class:"mt-1 block w-full",placeholder:"1"},null,8,["modelValue"])]),t("div",null,[l(p,{for:"component_notes",value:"Notas (Opcional)"}),_(t("textarea",{id:"component_notes","onUpdate:modelValue":o[7]||(o[7]=e=>n(c).notes=e),rows:"3",class:"mt-1 py-2 px-3 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"Notas adicionales..."},null,512),[[j,n(c).notes]])])])]),footer:u(()=>[l(F,{onClick:U},{default:u(()=>[...o[18]||(o[18]=[g(" Cancelar ",-1)])]),_:1}),l($,{class:C(["ml-3",{"opacity-25":n(c).processing}]),disabled:n(c).processing||!G.value,onClick:se},{default:u(()=>[n(c).processing?(i(),a("span",ye,"Creando...")):(i(),a("span",ge,"Crear Componente"))]),_:1},8,["class","disabled"])]),_:1},8,["show"]),l(A,{show:M.value,onClose:h},{title:u(()=>[...o[19]||(o[19]=[g(" Ensamblar Kit ",-1)])]),content:u(()=>[t("div",_e,[t("div",null,[l(p,{for:"kit_id",value:"Kit"}),_(t("select",{id:"kit_id","onUpdate:modelValue":o[8]||(o[8]=e=>n(m).kit_id=e),onChange:Z,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[o[20]||(o[20]=t("option",{value:""},"Seleccionar kit...",-1)),(i(!0),a(k,null,b(z.value,e=>(i(),a("option",{key:e.id,value:e.id},r(e.name)+" (Stock: "+r(e.current_stock)+" "+r(e.unit)+") ",9,ke))),128))],544),[[x,n(m).kit_id]])]),f.value&&f.value.components?(i(),a("div",be,[o[21]||(o[21]=t("h4",{class:"text-sm font-medium text-gray-700 mb-2"},"Componentes/Elementos requeridos:",-1)),t("div",we,[(i(!0),a(k,null,b(f.value.components,e=>(i(),a("div",{key:e.item.id,class:C(["flex justify-between items-center text-sm",e.sufficient?"text-green-700":"text-red-700"])},[t("span",null,r(e.item.name)+" ("+r(e.item.type)+")",1),t("span",null,[g(" Necesario: "+r(e.quantity_needed)+" | Disponible: "+r(e.available_stock)+" ",1),e.sufficient?V("",!0):(i(),a("span",Ce," ⚠️"))])],2))),128))])])):V("",!0),t("div",null,[l(p,{for:"kit_quantity",value:"Cantidad a Ensamblar"}),l(E,{id:"kit_quantity",modelValue:n(m).quantity,"onUpdate:modelValue":o[9]||(o[9]=e=>n(m).quantity=e),type:"number",min:"1",class:"mt-1 block w-full",placeholder:"1"},null,8,["modelValue"])]),t("div",null,[l(p,{for:"kit_notes",value:"Notas (Opcional)"}),_(t("textarea",{id:"kit_notes","onUpdate:modelValue":o[10]||(o[10]=e=>n(m).notes=e),rows:"3",class:"mt-1 py-2 px-3 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"Notas adicionales..."},null,512),[[j,n(m).notes]])])])]),footer:u(()=>[l(F,{onClick:h},{default:u(()=>[...o[22]||(o[22]=[g(" Cancelar ",-1)])]),_:1}),l($,{class:C(["ml-3",{"opacity-25":n(m).processing}]),disabled:n(m).processing||!H.value,onClick:le},{default:u(()=>[n(m).processing?(i(),a("span",xe,"Ensamblando...")):(i(),a("span",Ee,"Ensamblar Kit"))]),_:1},8,["class","disabled"])]),_:1},8,["show"])],64))}};export{Ke as default};
